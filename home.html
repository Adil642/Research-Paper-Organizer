<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Research Paper Organizer</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" />
  <!-- SweetAlert2 CDN -->
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="48x48" href="/favicon/favicon-48x48.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png" />
  <link rel="manifest" href="/site.webmanifest" />
  <link rel="stylesheet" href="css/style.css" />
  <style>
    /* Ensure dark mode styles work */
    body.dark-mode {
      background: #111827 !important;
      color: #d1d5db !important;
    }
    
    body.dark-mode .header {
      background: #1f2937 !important;
      color: #d1d5db !important;
    }
    
    body.dark-mode .search-bar {
      background: #1f2937 !important;
      color: #d1d5db !important;
    }
    
    body.dark-mode .papers-section {
      background: #1f2937 !important;
      color: #d1d5db !important;
    }
    
    body.dark-mode .paper-card {
      background: #374151 !important;
      color: #d1d5db !important;
      border-color: #4b5563 !important;
    }
    
    body.dark-mode .modal {
      background: #1f2937 !important;
      color: #d1d5db !important;
    }
    
    body.dark-mode input, 
    body.dark-mode textarea, 
    body.dark-mode select {
      background: #374151 !important;
      color: #d1d5db !important;
      border-color: #4b5563 !important;
    }

    #drop-zone {
      border: 2px dashed #4a90e2;
      border-radius: 16px;
      padding: 35px;
      text-align: center;
      background: #f8fbff;
      color: #4a90e2;
      transition: all 0.3s;
    }
    #drop-zone:hover {
      background: #eef4ff;
      border-color: #357ABD;
      transform: scale(1.02);
    }
    .label-1 {
      margin-top: 10px;
      background: linear-gradient(90deg, #0056b3, #00BFFF); /* darker to lighter blue */
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      font-weight: 700; /* bolder */
      font-size: 15px;  /* increased size */
      letter-spacing: 0.5px; /* adds spacing for a cleaner look */
    }
    .label-1:hover {
      margin-top: 10px;
      background: linear-gradient(90deg, #185ba3, #add3e0); /* darker to lighter blue */
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      font-size: 17px;  /* increased size */
    }

    /* General Paper Details Section */
    .details-section {
      background-color: #f9f9f9; /* light default */
      color: #111; 
      padding: 20px;
      border-radius: 10px;
      margin: 10px 0;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      transition: all 0.3s ease;
      font-family: 'Segoe UI', sans-serif;
    }

    /* Dark Mode */
    .details-section.dark-mode {
      background-color: #1f1f2e;
      color: #e0e0e0;
      box-shadow: 0 2px 8px rgba(255,255,255,0.05);
    }

    /* Detail Titles */
    .details-title, .detail-section h3, .detail-section h4 {
      margin-bottom: 8px;
      color: inherit;
    }

    /* Content Paragraphs */
    .detail-section p {
      margin: 5px 0 12px 0;
      line-height: 1.5;
      color: inherit;
    }

    /* Tags */
    .tags-container {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
    }
    .detail-tag {
      background-color: #e0e0e0;
      color: #111;
      padding: 3px 8px;
      border-radius: 4px;
      font-size: 0.85rem;
    }
    .details-section.dark-mode .detail-tag {
      background-color: #33334d;
      color: #f0f0f0;
    }

    /* Rating & Favorite */
    .rating-favorite-details {
      display: flex;
      justify-content: space-between;
      margin: 12px 0;
    }
    .paper-rating .stars {
      color: #ffc107; /* gold stars */
      font-size: 1.1rem;
    }
    .details-section.dark-mode .paper-rating .stars {
      color: #ffcc00;
    }
    .paper-favorite i {
      color: #e74c3c; /* red heart */
    }

    /* PDF Preview */
    .pdf-preview {
      width: 100%;
      height: 300px;
      border-radius: 8px;
      border: 1px solid #ccc;
    }
    .details-section.dark-mode .pdf-preview {
      border: 1px solid #444;
    }

    /* Citation Section */
    .citation-section {
      margin-top: 15px;
    }
    .citation-item {
      background-color: #f0f0f0e7;
      padding: 10px;
      border-radius: 6px;
      margin-bottom: 8px;
    }
    .details-section.dark-mode .citation-item {
      background-color: #2a2a3c;
    }
    .citation-text {
      font-size: 0.9rem;
      margin-top: 4px;
      color: inherit;
    }
    .copy-btn {
      background: none;
      border: none;
      cursor: pointer;
      color: #3498db;
      margin-left: 8px;
    }
    .details-section.dark-mode .copy-btn {
      color: #6ab0ff;
    }
    .details-section.dark-mode .details-title {
      border-bottom: 1px solid #555;
      padding-bottom: 6px;
      margin-bottom: 12px;
    }
    /* Light mode */
    .detail-label {
      font-weight: 500;
      color: #374151; /* dark gray for readability */
    }

    /* Dark mode */
    body.dark-mode .detail-label {
      color: #dcdce6; /* light gray for dark theme */
    }
    .detail-label {
      transition: color 0.3s ease;
    }
    .details-title {
      position: relative;
      display: inline-block;
      padding-bottom: 5px;
    }

    .details-title::after {
      content: "";
      position: absolute;
      left: 0;
      bottom: 0;
      width: 100%;
      height: 2px;
      background-color: #374151; /* light mode */
    }

    body.dark-mode .details-title::after {
      background-color: #dcdce6; /* dark mode */
    }

    /* Adil did this: constrain wide layouts and improve small-screen spacing */
    @media (max-width: 640px) {
      /* Header layout helpers */
      .header,
      .header-container,
      .header-content {
        display: flex;
        flex-wrap: wrap;
        gap: 0.5rem;
      }

      .header-buttons {
        display: flex;
        flex-wrap: wrap;
        gap: 0.5rem;
        width: 100%;
        justify-content: flex-start;
      }

      /* Search and filters stack vertically */
      .search-bar {
        display: grid;
        grid-template-columns: 1fr;
        gap: 0.75rem;
      }

      /* Tables/cards become full width */
      .table,
      table,
      .cards,
      .card,
      .papers-list,
      .paper-item {
        width: 100%;
        overflow-x: auto;
      }

      /* Make generic buttons easier to tap */
      button,
      .btn,
      .btn-primary,
      .btn-secondary,
      .add-btn,
      .dark-toggle {
        min-height: 40px;
        min-width: 40px;
        font-size: 0.95rem;
        padding: 0.5rem 0.75rem;
        cursor: pointer;
      }

      /* Mobile menu defaults to hidden, opens with .is-open */
      #menu-items-container {
        display: none;
        flex-direction: column;
        gap: 0.5rem;
      }
      #menu-items-container.is-open {
        display: flex;
      }

      /* Show open icon by default on mobile, hide close until opened */
      #menu-open-btn { display: inline-block; }
      #menu-close-btn { display: none; }
      #menu-close-btn.is-visible { display: inline-block; }
      #menu-open-btn.is-hidden { display: none; }
    }
  </style>
</head>

<body>
  <div class="container">
    <nav class="navbar">
      <a href="#" class="nav-item">Home</a>

      <div class="navbar-right-links">
        <a href="about.html" class="nav-item">About us</a>
        <a href="blog.html" class="nav-item">Blogs</a>
        <a href="Faq.html" class="nav-item">FAQ</a>
        <a href="contact.html" class="nav-item">Contact Us</a>
        <a href="tools.html" class="nav-item">Tools</a>
      </div>
    </nav>
    <!-- Header -->
    <div class="header">
      <div class="header-content">
        <div>
          <h1 class="header-title">
            <i class="fas fa-book-open"></i>
            Research Paper Organizer
          </h1>
          <p class="header-subtitle">
            Organize, track, and cite your research papers efficiently
          </p>
        </div>

        <!-- Right side buttons -->
        <div class="header-buttons">
          <button class="dark-toggle" id="darkModeToggle" title="Toggle Dark Mode">
            <i class="fas fa-moon"></i>
          </button>

          <button class="add-btn" onclick="showAddForm()">
            <i class="fas fa-plus"></i>
            Add Paper
          </button>
          <button class="add-btn" onclick="location.href='summarize.html'">
            <i class="fas fa-align-left"></i>
            Summarize Paper
          </button>

          <button class="btn-secondary" onclick="importPapers()">
            <i class="fas fa-file-import"></i> Import
          </button>

          <button class="btn-secondary" onclick="exportPapers()">
            <i class="fas fa-file-export"></i> Export
          </button>

        </div>
      </div>
      <div class="menu">
        <svg id="menu-open-btn" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
          stroke="currentColor" class="menu-btn">
          <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
        </svg>

        <div id="menu-items-container">
          <a href="#" class="menu-item">Home</a>
          <a href="#" class="menu-item">About us</a>

          <a href="#" class="menu-item">FAQ</a>
          <a href="contact.html" class="menu-item">Contact Us</a>
        </div>
        <svg id="menu-close-btn" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
          stroke="currentColor" class="menu-btn">
          <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12" />
        </svg>
      </div>
    </div>

    <!-- Search and Filter Bar -->
    <div class="search-bar">
      <div class="search-content">
        <div class="search-input-container">
          <i class="fas fa-search search-icon"></i>
          <input type="text" class="search-input" placeholder="Search papers by title, author, or abstract..."
            id="searchInput" oninput="filterPapers()" />
        </div>
        <div class="filter-container">
          <i class="fas fa-filter" style="color: #6b7280"></i>
          <select class="filter-select" id="topicFilter" onchange="filterPapers()">
            <option value="">All Topics</option>
          </select>
        </div>
        <div class="filter-container">
          <!-- Year Range -->
          <select id="minYear" class="filter-select">
            <option value="">From Year</option>
          </select>

          <div class="filter-container">
            <!-- Favorites Filter -->
            <select
              class="filter-select"
              id="favoriteFilter"
              onchange="filterPapers()"
            >
              <option value="">All Papers</option>
              <option value="favorites">Favorites Only</option>
              <option value="non-favorites">Non-Favorites</option>
            </select>
          </div>
          <div class="filter-container">
            <!-- Rating Filter -->
            <select
              class="filter-select"
              id="ratingFilter"
              onchange="filterPapers()"
            >
              <option value="">All Ratings</option>
              <option value="5">5 Stars</option>
              <option value="4">4+ Stars</option>
              <option value="3">3+ Stars</option>
              <option value="2">2+ Stars</option>
              <option value="1">1+ Stars</option>
              <option value="0">Unrated</option>
            </select>
          </div>
          <div class="filter-container">
            <!-- Sort Options -->
            <select
              class="filter-select"
              id="sortFilter"
              onchange="filterPapers()"
            >
              <option value="">Default</option>
              <option value="rating-desc">Highest Rated</option>
              <option value="rating-asc">Lowest Rated</option>
              <option value="favorites">Favorites First</option>
              <option value="title-asc">Title A-Z</option>
              <option value="title-desc">Title Z-A</option>
              <option value="year-desc">Newest First</option>
              <option value="year-asc">Oldest First</option>
            </select>
          </div>
        </div>
      </div>
    </div>
    <div class="main-grid">
      <!-- Papers List -->
      <div class="papers-section">
        <h2 class="papers-title">Papers (<span id="paperCount">0</span>)</h2>

        <div id="emptyState" class="empty-state">
          <i class="fas fa-book-open"></i>
          <p>No papers found</p>
          <p style="font-size: 0.875rem">
            Add your first research paper to get started
          </p>
        </div>

        <div id="papersList" class="papers-list hidden"></div>
        <!-- Pagination Controls for navigating between pages (ADDED FOR PAGINATION FEATURE) -->
        <div id="paginationControls" class="pagination-controls"></div>
      </div>

      <!-- Paper Details -->
      <div class="details-section">
        <div id="noSelection" class="empty-state">
          <i class="fas fa-book-open"></i>
          <p>Select a paper to view details</p>
        </div>

        <div id="paperDetails" class="hidden">
          <div class="details-header">
            <h2 class="details-title">Paper Details</h2>
            <button class="close-btn" onclick="closeDetails()">
              <i class="fas fa-times"></i>
            </button>
          </div>
          <div class="details-content" id="detailsContent">
            <!-- Paper details go here -->
          </div>
        </div>
      </div>
    </div>

    <!-- Add/Edit Paper Modal -->
    <div id="modalOverlay" class="modal-overlay hidden">
      <div class="modal">
        <div class="modal-content">
          <div class="modal-header">
            <h2 class="modal-title" id="modalTitle">Add New Paper</h2>
            <button class="modal-close" onclick="hideAddForm()">
              <i class="fas fa-times"></i>
            </button>
          </div>

          <form id="paperForm">
            <div id="drop-zone">
              <div class="icon">
                <i class="fas fa-cloud-upload-alt"></i>
              </div>
              <h3>Drag & Drop to Upload File</h3>
              <p>OR</p>
              <button id="browse-btn" type="button">Browse File</button>
              <input type="file" id="pdfUpload" accept="application/pdf" required hidden />
            </div>
            <!-- Placeholder for showing uploaded file -->
            <div id="uploaded-file" class="uploaded-file" style="display:none;"></div>
            
            <div id="pdfPreviewContainer" class="pdf-preview-container hidden">
              <label class="form-label label-1">PDF Preview</label>
              <iframe
                id="pdfPreview"
                class="pdf-preview"
                src=""
                frameborder="0"
              ></iframe>
              
            </div>

            <div class="form-group">
              <label class="form-label label-1">Title *</label>
              <input type="text" class="form-input" id="title" required />
            </div>

            <div class="form-grid">
              <div class="form-group">
                <label class="form-label label-1">Authors *</label>
                <input type="text" class="form-input" id="authors" required />
              </div>
              <div class="form-group">
                <label class="form-label label-1">Year</label>
                <input type="number" class="form-input" id="year" />
              </div>
            </div>

            <div class="form-grid">
              <div class="form-group">
                <label class="form-label label-1">Journal/Conference</label>
                <input type="text" class="form-input" id="journal" />
              </div>
              <div class="form-group">
                <label class="form-label label-1">Topic</label>
                <input type="text" class="form-input" id="topic" />
              </div>
            </div>

            <div class="form-group">
              <label class="form-label label-1">URL</label>
              <input type="url" class="form-input" id="url" />
            </div>

            <div class="form-group">
              <label class="form-label label-1">Tags (comma-separated)</label>
              <input type="text" class="form-input" id="tags" placeholder="machine learning, neural networks, AI" />
            </div>

            <div class="form-group">
              <label class="form-label label-1">Abstract</label>
              <textarea class="form-textarea" id="abstract" rows="3"></textarea>
            </div>

            <div class="form-group">
              <label class="form-label label-1">Notes</label>
              <textarea class="form-textarea" id="notes" rows="4"></textarea>
            </div>

            <!-- Rating and Favorite Section -->
            <div class="form-grid">
              <div class="form-group">
                <label class="form-label label-1">Rating</label>
                <div class="rating-container">
                  <div class="stars-rating" id="starsRating">
                    <span class="star" data-rating="1">★</span>
                    <span class="star" data-rating="2">★</span>
                    <span class="star" data-rating="3">★</span>
                    <span class="star" data-rating="4">★</span>
                    <span class="star" data-rating="5">★</span>
                  </div>
                  <input type="hidden" id="rating" value="0" />
                </div>
              </div>
              <div class="form-group">
                <label class="form-label label-1">Favorite</label>
                <div class="favorite-container">
                  <label class="favorite-checkbox">
                    <input type="checkbox" id="isFavorite" />
                    <span class="favorite-icon" style="margin-top: 10px;">
                      <i class="fas fa-heart"></i>
                    </span>
                    <span class="favorite-text"><p class="label-1">Mark as favorite</p></span>
                  </label>
                </div>
              </div>
            </div>

            <div class="form-actions">
              <button type="button" class="btn-secondary" onclick="hideAddForm()">
                Cancel
              </button>
              <button type="submit" class="btn-primary">
                <i class="fas fa-save"></i>
                <span id="submitText">Add Paper</span>
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
    <div id="loadingSpinner" class="loading-spinner hidden">
      <i class="fas fa-spinner fa-spin"></i> Saving Paper...
    </div>
  </div>

  <!-- Back to Top Button -->
  <button id="backToTop" title="Go to top">↑</button>

  <!-- Footer -->
  <footer class="blog-footer" aria-label="Footer">
    <div class="footer-content">
      <div class="footer-section">
        <h3><i class="fas fa-book-open" aria-hidden="true"></i> Research Paper Organizer</h3>
        <p>Streamline your academic workflow with our intelligent research paper management system.</p>
      </div>
      <div class="footer-section">
        <h4>Quick Links</h4>
        <ul class="footer-links">
          <li><a href="index.html">Home</a></li>
          <li><a href="about.html">About Us</a></li>
          <li><a href="contact.html">Contact</a></li>
          <li><a href="Faq.html">FAQ</a></li>
        </ul>
      </div>
      <div class="footer-section">
        <h4>Resources</h4>
        <ul class="footer-links">
          <li><a href="blog.html">Blog</a></li>
          <li><a href="glossary.html">Glossary</a></li>
          <li><a href="open-source.html">Open Source</a></li>
          <li><a href="Masthead.html">Masthead</a></li>
        </ul>
      </div>
      <div class="footer-section">
        <h4>Connect</h4>
        <div class="social-links">
          <a href="https://github.com/supriya46788/Research-Paper-Organizer" target="_blank" title="GitHub" rel="noopener">
            <i class="fab fa-github" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span>
          </a>
          <a href="#" target="_blank" title="Twitter" rel="noopener">
            <i class="fab fa-twitter" aria-hidden="true"></i>
            <span class="sr-only">Twitter</span>
          </a>
          <a href="https://www.linkedin.com/in/supriyapandey595" target="_blank" title="LinkedIn" rel="noopener">
            <i class="fab fa-linkedin" aria-hidden="true"></i>
            <span class="sr-only">LinkedIn</span>
          </a>
        </div>
      </div>
    </div>
    <div class="footer-bottom">
      <p>© 2025 Research Paper Organizer | Open Source Project</p>
      <p class="footer-tagline">Made with <i class="fas fa-heart" style="color: #e74c3c;" aria-hidden="true"></i> for researchers worldwide</p>
    </div>
  </footer>

  <script>
    // Authentication check
    function checkAuthentication() {
      const currentUser = localStorage.getItem('current_user');
      if (!currentUser) {
        window.location.href = 'landing.html'; // Redirect to landing page if not authenticated
        return false;
      }
      return true;
    }

    // Run auth check before loading script
    if (!checkAuthentication()) {
      throw new Error('User not authenticated');
    }

    //back to top button 
    // Show button when scrolled down
    const backToTop = document.getElementById("backToTop");

    window.addEventListener("scroll", () => {
      if (window.scrollY > 100) {
        backToTop.style.display = "block";
      } else {
        backToTop.style.display = "none";
      }
    });

    // Smooth scroll to top
    backToTop.addEventListener("click", () => {
      window.scrollTo({ top: 0, behavior: "smooth" });
    });

    // Adil did this: Wrap in DOMContentLoaded to ensure elements exist
    document.addEventListener('DOMContentLoaded', function () {
      // Adil did this: Find possible menu toggles (SVG buttons and any .fa-bars)
      const openBtn = document.getElementById('menu-open-btn');
      const closeBtn = document.getElementById('menu-close-btn');
      const faBars = document.querySelector('.fa-bars'); // in case a font-awesome icon is used
      const menu = document.getElementById('menu-items-container');

      // Adil did this: Safe-guard if menu container missing
      if (!menu) return;

      // Adil did this: Helper functions for open/close with ARIA
      function openMenu() {
        menu.classList.add('is-open');
        menu.setAttribute('aria-hidden', 'false');
        menu.setAttribute('role', 'menu');
        if (openBtn) openBtn.classList.add('is-hidden');
        if (closeBtn) closeBtn.classList.add('is-visible');
        if (openBtn) openBtn.setAttribute('aria-expanded', 'true');
        if (closeBtn) closeBtn.setAttribute('aria-expanded', 'true');
      }

      function closeMenu() {
        menu.classList.remove('is-open');
        menu.setAttribute('aria-hidden', 'true');
        if (openBtn) openBtn.classList.remove('is-hidden');
        if (closeBtn) closeBtn.classList.remove('is-visible');
        if (openBtn) openBtn.setAttribute('aria-expanded', 'false');
        if (closeBtn) closeBtn.setAttribute('aria-expanded', 'false');
      }

      // Adil did this: Initialize ARIA state for better accessibility
      menu.setAttribute('aria-hidden', 'true');
      if (openBtn) {
        openBtn.setAttribute('aria-controls', 'menu-items-container');
        openBtn.setAttribute('aria-expanded', 'false');
        openBtn.style.cursor = 'pointer';
      }
      if (closeBtn) {
        closeBtn.setAttribute('aria-controls', 'menu-items-container');
        closeBtn.setAttribute('aria-expanded', 'false');
        closeBtn.style.cursor = 'pointer';
      }
      if (faBars) {
        faBars.setAttribute('role', 'button');
        faBars.setAttribute('aria-controls', 'menu-items-container');
        faBars.setAttribute('aria-expanded', 'false');
        faBars.style.cursor = 'pointer';
      }

      // Adil did this: Attach event listeners to any available toggles
      if (openBtn) openBtn.addEventListener('click', openMenu);
      if (closeBtn) closeBtn.addEventListener('click', closeMenu);
      if (faBars) faBars.addEventListener('click', function () {
        const isOpen = menu.classList.contains('is-open');
        if (isOpen) {
          closeMenu();
        } else {
          openMenu();
        }
      });

      // Adil did this: Close menu when clicking a menu item (improves UX on mobile)
      menu.addEventListener('click', function (e) {
        const target = e.target;
        if (target && (target.matches('a') || target.closest('a'))) {
          closeMenu();
        }
      });

      // Adil did this: Handle viewport changes to reset menu for desktop widths
      const mql = window.matchMedia('(min-width: 641px)');
      function handleResize(e) {
        if (e.matches) {
          // Desktop: ensure menu is visible using existing site CSS (no forced hide)
          menu.classList.remove('is-open');
          if (openBtn) openBtn.classList.remove('is-hidden');
          if (closeBtn) closeBtn.classList.remove('is-visible');
          menu.setAttribute('aria-hidden', 'false');
        } else {
          // Mobile: keep menu closed by default
          closeMenu();
        }
      }
      handleResize(mql);
      mql.addEventListener('change', handleResize);
    });
  </script>

  <script src="js/script.js"></script>

  <!-- Chatbase Integration -->
  <script>
    (function(){
      if(!window.chatbase || window.chatbase("getState") !== "initialized"){
        window.chatbase = (...arguments) => {
          if(!window.chatbase.q){ window.chatbase.q = [] }
          window.chatbase.q.push(arguments)
        };
        window.chatbase = new Proxy(window.chatbase, {
          get(target, prop) {
            if(prop === "q"){ return target.q }
            return (...args) => target(prop, ...args)
          }
        });
      }
      const onLoad = function(){
        const script = document.createElement("script");
        script.src = "https://www.chatbase.co/embed.min.js";
        script.id = "SZQX20er6m-s8iNiFcBtK";
        script.domain = "www.chatbase.co";
        document.body.appendChild(script)
      };
      if(document.readyState === "complete"){ onLoad() }
      else { window.addEventListener("load", onLoad) }
    })();
  </script>
</body>

</html>
